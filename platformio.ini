; ============================================================================
; Moto32 Firmware â€“ PlatformIO Configuration
; ESP32-WROOM-32D Motorcycle Control Unit
; ============================================================================

[env:esp32-wroom-32d]
platform = espressif32
board = esp32dev
framework = arduino

; ---- Partition table with OTA support (FIX #9) ----
board_build.filesystem = littlefs
board_build.partitions = partitions_ota.csv

; ---- Libraries ----
lib_deps =
  h2zero/NimBLE-Arduino@^1.4.0
  mathieucarbou/ESPAsyncWebServer@^3.3.0
  bblanchon/ArduinoJson@^7.0.0

; ---- Build flags ----
build_flags =
  -DLOG_LEVEL=LOG_INFO
  -DCONFIG_BT_NIMBLE_ROLE_PERIPHERAL=1
  -DCONFIG_BT_NIMBLE_ROLE_CENTRAL=0
  -DCONFIG_BT_NIMBLE_ROLE_OBSERVER=1
  -DCONFIG_BT_NIMBLE_ROLE_BROADCASTER=1
  -DCONFIG_BT_NIMBLE_MAX_CONNECTIONS=2

; ---- Upload & Monitor ----
upload_speed = 921600
monitor_speed = 115200
monitor_dtr = 0
monitor_rts = 0
monitor_filters = esp32_exception_decoder

; ---- Debug build (optional, uncomment to enable) ----
; [env:debug]
; extends = env:esp32-wroom-32d
; build_flags =
;   ${env:esp32-wroom-32d.build_flags}
;   -DLOG_LEVEL=LOG_DEBUG
;   -DCORE_DEBUG_LEVEL=4
