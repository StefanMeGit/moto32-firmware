; ============================================================================
; Moto32 Firmware â€“ PlatformIO Configuration
; Default target: ESP32-S3 N16R8
; ============================================================================

[platformio]
default_envs = esp32-s3-n16r8

[env]
platform = espressif32
framework = arduino

; ---- Libraries ----
lib_deps =
  h2zero/NimBLE-Arduino@^1.4.0
  mathieucarbou/ESPAsyncWebServer@^3.3.0
  bblanchon/ArduinoJson@^7.0.0

; ---- Build flags ----
build_flags =
  -DLOG_LEVEL=LOG_INFO
  -DCONFIG_BT_NIMBLE_MAX_CONNECTIONS=2

; ---- Upload & Monitor ----
upload_speed = 460800
monitor_speed = 115200
monitor_dtr = 0
monitor_rts = 0
monitor_filters = esp32_exception_decoder

; ---- ESP32-S3 N16R8 (default) ----
[env:esp32-s3-n16r8]
board = esp32-s3-devkitc-1-n16r8
board_build.partitions = partitions_ota_16mb.csv
board_build.flash_mode = qio
board_build.arduino.memory_type = qio_opi

; ---- ESP32-S3 DevKitC-1 (4MB Flash) ----
[env:esp32-s3-4mb]
board = esp32-s3-devkitc-1-4mb
board_build.partitions = partitions_ota.csv
upload_speed = 460800

; ---- Optional legacy target: ESP32-WROOM-32D ----
[env:esp32-wroom-32d]
board = esp32dev
board_build.partitions = partitions_ota.csv
upload_speed = 921600

; ---- Debug build (optional, uncomment to enable; picks default env flags) ----
; [env:debug]
; extends = env:esp32-s3-n16r8
; build_flags =
;   ${env:esp32-s3-n16r8.build_flags}
;   -DLOG_LEVEL=LOG_DEBUG
;   -DCORE_DEBUG_LEVEL=4
